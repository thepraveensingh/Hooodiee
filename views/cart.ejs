<%- include('./partials/header') %>

<% if (user.cart.length == 0) { %>
    <div class="text-center pt-20">
        <div class="text-7xl mb-4">ðŸ˜ž</div> 
        <div class="text-5xl font-bold">Your Cart is Empty!</div>
    </div>
<% }else{ %>

<% 
let totalCheckoutPrice = 0; // Initialize total checkout price

user.cart.forEach((item) => { 
    const netTotal = item.price - item.discount; // Calculate the net total for the item
    totalCheckoutPrice += netTotal + 20; // Add net total + platform fee to the total checkout price
%>
    <div class="w-full flex items-start px-20 py-10 gap-10 ">
        <div class="w-[30%] rounded-md bg-[<%= item.panelColor %>] overflow-hidden">
            <div class="w-full h-60 bg-[<%= item.bgColor %>]"> 
                <img class="h-full w-full object-contain" src="data:image/jpeg;base64,<%= item.image.toString('base64') %>" alt=""> 
            </div>
            <div class="w-full flex justify-between px-4 py-3 text-[<%= item.textColor %>]">  
                <h3 class="text-xl"><%= item.name %></h3> 
                <div class="flex items-center gap-2">
                    <a href="/minusCart/<%= item._id %>">
                        <i class="w-6 h-6 bg-white flex rounded-full items-center justify-center ri-subtract-line"></i>
                    </a>
                    <div class="px-2 py-1 rounded-md bg-white text-black">01</div>
                    <a href="/plusCart/<%= item._id %>">
                        <i class="w-6 h-6 bg-white flex rounded-full items-center justify-center ri-add-line"></i> 
                    </a>
                </div>
            </div>
            <div class="flex items-center justify-between px-4 py-2 text-white"> 
                <h4 class="text-md">Net Total</h4>
                <h2 class="text-md">â‚¹ <%= netTotal %></h2> 
            </div>
        </div> 
        <div class="w-[70%] mt-0">
            <h3 class="text-xl">Price Breakdown</h3>
            <div class="px-10 mt-5">
                <div class="flex mt-1">
                    <h4 class="w-1/3">Total MRP</h4>
                    <h4>â‚¹ <%= item.price %></h4>
                </div>
                <div class="flex mt-1">
                    <h4 class="w-1/3">Discount on MRP</h4>
                    <h4>â‚¹ <%= item.discount %></h4>
                </div>
                <div class="flex mt-1">
                    <h4 class="w-1/3">Platform Fee</h4>
                    <h4>â‚¹ 20</h4> <!-- Fixed platform fee -->
                </div>
                <div class="flex mt-1">
                    <h4 class="w-1/3">Shipping Fee</h4>
                    <h4>FREE</h4>
                </div>
            </div>
            <div class="w-full h-[1px] bg-black mt-5"></div>
            <div class="flex mt-3">
                <h3 class="w-1/3 text-xl">Total Amount</h3>
                <h3 class="font-semibold text-xl text-green-600">â‚¹ <%= netTotal %></h3> <!-- Display net total for each item -->
            </div>
        </div>
    </div>
<% }) %>


<div class="fixed bottom-0 left-0 w-full bg-[#F7F7F8] shadow-md py-3 px-10 border-t-1">
    <div class="w-full flex justify-between items-center px-10">
        <div class="flex items-center gap-5">
            <h3 class="text-2xl text-black font-bold ">Total Checkout Price:</h3>
            <h3 class="text-2xl  text-green-600 font-bold">â‚¹ <%= totalCheckoutPrice %></h3> 
        </div>
        <a href="/checkout" class="bg-black text-white px-5 py-3 shadow-sm rounded-lg flex items-center justify-center text-center text-l">
            Proceed to Checkout
        </a>
    </div>
</div>
<%}%>
<%- include('./partials/footer') %>
